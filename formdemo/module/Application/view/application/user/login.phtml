<?php

$this->headTitle('Log in');

$this->mainMenu()->setActiveItemId('home');

$this->pageBreadcrumbs()->setItems(array(
            'Home'=>$this->url('home'),
            'Log in'=>$this->url('application/default', array('controller'=>'user', 'action'=>'login'))
            ));

$form = $this->form;

$form->get('email')->setAttributes(array(
    'class'=>'form-control', 
    'placeholder'=>'name@example.com'
    ));

$form->get('password')->setAttributes(array(
    'class'=>'form-control', 
    'placeholder'=>'Your Password'
    ));

$form->get('submit')->setAttributes(array(
    'class'=>'btn btn-primary'
    ));

$form->prepare();

?>

<div id="form-container" class="row">
    
    <?php 
    
    echo $this->partial('application/user/form.phtml');
    
    ?>
    
</div>
         
<script type="text/javascript">
    
    $( document ).ready(function() {
        
        $( "input" ).on('change', function() {            
            var form = $('form#login-form');
            var fieldId = $(this).attr("id");
            var data = form.serialize();
            alert(data);
            $.ajax({              
              type: form.attr('method'),
              url: form.attr('action') + '?fieldId=' + fieldId,
              data: form.serialize()
            }).done(function(data, status, xhrObj) {              

                $('div#form-container').html(data);

                var isFormValid = xhrObj.getResponseHeader("X-Form-Valid");
                
                if(isFormValid=="yes") {        
                   
                }

            }).fail(function(data) {
                // Optionally alert the user of an error here...        
                alert('Error submitting form');                
            });
        });  
    });
    
</script>